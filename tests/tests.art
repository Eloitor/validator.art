import {unitt}!

loop list ./"../src/plugins" 'location [
    name: extract.filename location
    plugin: # location
    params: #[]
    run: [do [plugin\action v params]]
    
    suite capitalize name [
        test "valid" [
            assert ->
                every? plugin\test\valid 'v run
        ]
        test "invalid" [
            assert ->
                not? some? plugin\test\invalid 'v run
        ]
    ]
]

import ./"../src/validator.art"!

suite "Test function calls" [
    test "single param" [
        assert -> valid?.email "drkameleon@gmail.com"
        assert -> valid?.url "https://arturo-lang.io"
        assert -> not? valid?.email "drkameleon"
        assert -> not? valid?.url "arturolang"
    ]

    test "multiple params" [
        assert -> valid?.email ["drkameleon@gmail.com", "yaniszaf@gmail.com"]
        assert -> valid?.url ["https://www.google.com", "https://arturo-lang.io"]
        assert -> not? valid?.email ["drkameleon", "yaniszaf"]
        assert -> not? valid?.email ["drkameleon@gmail.com", "yaniszaf"]
        assert -> not? valid?.url ["google", "arturolang"]
        assert -> not? valid?.url ["https://www.google.com", "arturolang"]
    ]
]